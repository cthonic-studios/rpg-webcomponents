{"moduleFile":{"sourceFilePath":"/home/ec2-user/environment/rpg-webcomponents/src/components/character-sheet/character-attribute/character-attribute.tsx","localImports":[],"externalImports":["@stencil/core"],"potentialCmpRefs":[{"tag":"editable-number"}],"cmpMeta":{"tagNameMeta":"character-attribute","stylesMeta":{"$":{"externalStyles":[{"absolutePath":"/home/ec2-user/environment/rpg-webcomponents/src/components/character-sheet/character-attribute/character-attribute.scss","cmpRelativePath":"./character-attribute.scss","originalComponentPath":"./character-attribute.scss"}]}},"assetsDirsMeta":[],"hostMeta":{},"dependencies":[],"jsdoc":{"name":"CharacterAttribute","tags":[],"documentation":"","type":"typeof CharacterAttribute"},"encapsulationMeta":0,"componentClass":"CharacterAttribute","membersMeta":{"el":{"memberType":64},"isEditable":{"memberType":16},"currentAttrValue":{"memberType":16},"bonus":{"memberType":16},"name":{"memberType":1,"attribName":"name","attribType":{"text":"string","required":false,"optional":false,"typeReferences":{}},"reflectToAttrib":false,"propType":2,"jsdoc":{"name":"name","tags":[],"documentation":"","type":"string"}},"showBonus":{"memberType":1,"attribName":"show-bonus","attribType":{"text":"boolean","required":false,"optional":false,"typeReferences":{}},"reflectToAttrib":false,"propType":4,"jsdoc":{"name":"showBonus","tags":[],"documentation":"","type":"boolean","default":"true"}},"attributeValue":{"memberType":1,"attribName":"attribute-value","attribType":{"text":"number","required":false,"optional":false,"typeReferences":{}},"reflectToAttrib":false,"propType":8,"jsdoc":{"name":"attributeValue","tags":[],"documentation":"","type":"number"},"watchCallbacks":["attrValueChanged"]},"attributeCap":{"memberType":1,"attribName":"attribute-cap","attribType":{"text":"number","required":false,"optional":false,"typeReferences":{}},"reflectToAttrib":false,"propType":8,"jsdoc":{"name":"attributeCap","tags":[],"documentation":"","type":"number"}},"bonusCalculation":{"memberType":1,"attribName":"bonus-calculation","attribType":{"text":"Function","required":false,"optional":false,"typeReferences":{"Function":{"referenceLocation":"global"}}},"reflectToAttrib":false,"propType":0,"jsdoc":{"name":"bonusCalculation","tags":[],"documentation":"","type":"Function"}},"styleType":{"memberType":1,"attribName":"style-type","attribType":{"text":"string","required":false,"optional":false,"typeReferences":{}},"reflectToAttrib":false,"propType":2,"jsdoc":{"name":"styleType","tags":[],"documentation":"","type":"string","default":"'vertical'"}}},"eventsMeta":[],"listenersMeta":[{"eventName":"rpg_setvalue","eventMethodName":"setValueFromEvent","eventCapture":false,"eventPassive":false,"eventDisabled":false,"jsdoc":{"name":"setValueFromEvent","tags":[],"documentation":"","type":"(event: CustomEvent<any>) => void"}},{"eventName":"clearBonus","eventMethodName":"clearBonus","eventCapture":false,"eventPassive":false,"eventDisabled":false,"jsdoc":{"name":"clearBonus","tags":[],"documentation":"","type":"() => void"}},{"eventName":"attributeDamage","eventMethodName":"attributeDamageOrBonus","eventCapture":false,"eventPassive":false,"eventDisabled":false,"jsdoc":{"name":"attributeDamageOrBonus","tags":[],"documentation":"","type":"(event: CustomEvent<any>) => void"}},{"eventName":"attributeBonus","eventMethodName":"attributeDamageOrBonus","eventCapture":false,"eventPassive":false,"eventDisabled":false,"jsdoc":{"name":"attributeDamageOrBonus","tags":[],"documentation":"","type":"(event: CustomEvent<any>) => void"}},{"eventName":"valueChanged","eventMethodName":"valueChanged","eventCapture":false,"eventPassive":false,"eventDisabled":false,"jsdoc":{"name":"valueChanged","tags":[],"documentation":"","type":"(event: CustomEvent<any>) => void"}}]},"hasSlot":false,"hasSvg":false,"jsFilePath":"/home/ec2-user/environment/rpg-webcomponents/src/components/character-sheet/character-attribute/character-attribute.js"},"jsText":"export class CharacterAttribute {\r\n    constructor() {\r\n        this.showBonus = true;\r\n        this.styleType = 'vertical';\r\n        this.isEditable = false;\r\n        this.bonus = 0;\r\n    }\r\n    attrValueChanged(newValue) {\r\n        this.setValue(parseInt(newValue));\r\n    }\r\n    setValueFromEvent(event) {\r\n        if (event.detail) {\r\n            this.setValue(event.detail);\r\n        }\r\n    }\r\n    clearBonus() {\r\n        this.setBonus(0);\r\n    }\r\n    attributeDamageOrBonus(event) {\r\n        let newBonus;\r\n        if (event.type === 'attributeBonus') {\r\n            newBonus = this.bonus + event.detail;\r\n        }\r\n        else {\r\n            newBonus = this.bonus - event.detail;\r\n        }\r\n        this.setBonus(newBonus);\r\n    }\r\n    setBonus(value) {\r\n        this.bonus = value;\r\n        if (this.bonus > 0) {\r\n            this.el.classList.add('is-boosted');\r\n        }\r\n        else {\r\n            this.el.classList.remove('is-boosted');\r\n        }\r\n        if (this.bonus < 0) {\r\n            this.el.classList.add('is-penalized');\r\n        }\r\n        else {\r\n            this.el.classList.remove('is-penalized');\r\n        }\r\n        this.setValue(this.currentAttrValue + this.bonus);\r\n    }\r\n    valueChanged(event) {\r\n        let newVal = event.detail;\r\n        if (this.currentAttrValue != newVal) {\r\n            if (this.attributeCap && newVal > this.attributeCap) {\r\n                newVal = this.attributeCap;\r\n                return this.setValue(newVal);\r\n            }\r\n            this.currentAttrValue = newVal;\r\n            this.bonus = this.calculateBonus();\r\n        }\r\n    }\r\n    componentWillLoad() {\r\n        this.styleClass = `character-attribute-${this.styleType}`;\r\n        this.currentAttrValue = this.attributeValue;\r\n        this.bonus = this.calculateBonus();\r\n    }\r\n    calculateBonus() {\r\n        if (this.bonusCalculation) {\r\n            return this.bonusCalculation(this.currentAttrValue);\r\n        }\r\n        return Math.floor(this.currentAttrValue / 2) - 5;\r\n    }\r\n    setValue(value) {\r\n        this.currentAttrValue = value;\r\n        this.bonus = this.calculateBonus();\r\n        let event = new CustomEvent('rpg_setvalue', { detail: this.currentAttrValue });\r\n        this.el.querySelector('editable-number').dispatchEvent(event);\r\n    }\r\n    clickToEdit(event) {\r\n        if (event.target.tagName == 'INPUT') {\r\n            return;\r\n        }\r\n        this.isEditable = !this.isEditable;\r\n        if (this.isEditable) {\r\n            setTimeout(() => {\r\n                this.el.querySelector('input').focus();\r\n            }, 0);\r\n        }\r\n    }\r\n    render() {\r\n        return (h(\"div\", { class: \"character-attribute-container \" + this.styleClass },\r\n            h(\"div\", { class: \"attribute-name\" }, this.name),\r\n            h(\"editable-number\", { startingValue: this.currentAttrValue }),\r\n            this.showBonus ?\r\n                h(\"div\", { class: \"attribute-bonus-container\" }, this.bonus)\r\n                :\r\n                    \"\"));\r\n    }\r\n    static get is() { return \"character-attribute\"; }\r\n    static get properties() { return {\r\n        \"attributeCap\": {\r\n            \"type\": Number,\r\n            \"attr\": \"attribute-cap\"\r\n        },\r\n        \"attributeValue\": {\r\n            \"type\": Number,\r\n            \"attr\": \"attribute-value\",\r\n            \"watchCallbacks\": [\"attrValueChanged\"]\r\n        },\r\n        \"bonus\": {\r\n            \"state\": true\r\n        },\r\n        \"bonusCalculation\": {\r\n            \"type\": \"Any\",\r\n            \"attr\": \"bonus-calculation\"\r\n        },\r\n        \"currentAttrValue\": {\r\n            \"state\": true\r\n        },\r\n        \"el\": {\r\n            \"elementRef\": true\r\n        },\r\n        \"isEditable\": {\r\n            \"state\": true\r\n        },\r\n        \"name\": {\r\n            \"type\": String,\r\n            \"attr\": \"name\"\r\n        },\r\n        \"showBonus\": {\r\n            \"type\": Boolean,\r\n            \"attr\": \"show-bonus\"\r\n        },\r\n        \"styleType\": {\r\n            \"type\": String,\r\n            \"attr\": \"style-type\"\r\n        }\r\n    }; }\r\n    static get listeners() { return [{\r\n            \"name\": \"rpg_setvalue\",\r\n            \"method\": \"setValueFromEvent\"\r\n        }, {\r\n            \"name\": \"clearBonus\",\r\n            \"method\": \"clearBonus\"\r\n        }, {\r\n            \"name\": \"attributeDamage\",\r\n            \"method\": \"attributeDamageOrBonus\"\r\n        }, {\r\n            \"name\": \"attributeBonus\",\r\n            \"method\": \"attributeDamageOrBonus\"\r\n        }, {\r\n            \"name\": \"valueChanged\",\r\n            \"method\": \"valueChanged\"\r\n        }]; }\r\n    static get style() { return \"/**style-placeholder:character-attribute:**/\"; }\r\n}\r\n"}